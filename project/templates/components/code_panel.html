<!-- 코드 스테이지 탭 -->
<div class="code-stage-tabs">
    <button class="code-stage-tab active" data-code-stage="pre">
        <span class="stage-icon">🟩</span> 전처리
    </button>
    <button class="code-stage-tab" data-code-stage="model">
        <span class="stage-icon">🟦</span> 모델
    </button>
    <button class="code-stage-tab" data-code-stage="train">
        <span class="stage-icon">🟧</span> 학습
    </button>
    <button class="code-stage-tab" data-code-stage="eval">
        <span class="stage-icon">🟥</span> 평가
    </button>
</div>

<!-- 코드 패널들 -->
<div class="code-panels">
    <!-- 전처리 코드 -->
    <div class="code-stage-panel active" data-code-panel="pre">
        {% if snippet_pre %}
        <div class="code-actions">
            <button class="btn btn-secondary" onclick="API.downloadCode('pre')">
                📥 다운로드
            </button>
            <button class="btn btn-primary" data-run="pre">
                ▶️ 실행
            </button>
            <button class="btn btn-secondary" onclick="app.tabManager.goToTab('log')">
                📋 로그 보기
            </button>
        </div>
        <pre class="code-view"><code>{{ snippet_pre | e }}</code></pre>
        {% else %}
        <div class="empty-state">
            <p class="text-muted">전처리 코드가 아직 생성되지 않았습니다.</p>
            <button class="btn btn-primary" onclick="document.querySelector('[name=stage][value=pre]').click()">
                생성하기
            </button>
        </div>
        {% endif %}
    </div>
    
    <!-- 모델 코드 -->
    <div class="code-stage-panel" data-code-panel="model">
        {% if snippet_model %}
        <div class="code-actions">
            <button class="btn btn-secondary" onclick="API.downloadCode('model')">
                📥 다운로드
            </button>
            <button class="btn btn-primary" data-run="model">
                ▶️ 테스트
            </button>
            <button class="btn btn-secondary" onclick="app.tabManager.goToTab('log')">
                📋 로그 보기
            </button>
        </div>
        <pre class="code-view"><code>{{ snippet_model | e }}</code></pre>
        {% else %}
        <div class="empty-state">
            <p class="text-muted">모델 코드가 아직 생성되지 않았습니다.</p>
            <button class="btn btn-primary" onclick="document.querySelector('[name=stage][value=model]').click()">
                생성하기
            </button>
        </div>
        {% endif %}
    </div>
    
    <!-- 학습 코드 -->
    <div class="code-stage-panel" data-code-panel="train">
        {% if snippet_train %}
        <div class="code-actions">
            <button class="btn btn-secondary" onclick="API.downloadCode('train')">
                📥 다운로드
            </button>
            <button class="btn btn-primary" data-run="train">
                ▶️ 실행
            </button>
            <button class="btn btn-secondary" onclick="app.tabManager.goToTab('log')">
                📋 로그 보기
            </button>
        </div>
        <pre class="code-view"><code>{{ snippet_train | e }}</code></pre>
        {% else %}
        <div class="empty-state">
            <p class="text-muted">학습 코드가 아직 생성되지 않았습니다.</p>
            <button class="btn btn-primary" onclick="document.querySelector('[name=stage][value=train]').click()">
                생성하기
            </button>
        </div>
        {% endif %}
    </div>
    
    <!-- 평가 코드 -->
    <div class="code-stage-panel" data-code-panel="eval">
        {% if snippet_eval %}
        <div class="code-actions">
            <button class="btn btn-secondary" onclick="API.downloadCode('eval')">
                📥 다운로드
            </button>
            <button class="btn btn-primary" data-run="eval">
                ▶️ 실행
            </button>
            <button class="btn btn-secondary" onclick="app.tabManager.goToTab('log')">
                📋 로그 보기
            </button>
        </div>
        <pre class="code-view"><code>{{ snippet_eval | e }}</code></pre>
        {% else %}
        <div class="empty-state">
            <p class="text-muted">평가 코드가 아직 생성되지 않았습니다.</p>
            <button class="btn btn-primary" onclick="document.querySelector('[name=stage][value=eval]').click()">
                생성하기
            </button>
        </div>
        {% endif %}
    </div>
</div>